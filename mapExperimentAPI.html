<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>API Experiment</title>
</head>

<body>

    <script type="text/javascript" src="d3/d3.v3.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
    <script type="text/javascript" src="mapExperiment.js"></script>
    <script src="PapaParse-4.1.2/papaparse.min.js"></script>

    <div id="mapContainer"></div>

    <script>

        getStateData = function(){

            var state_numbers = {};
            state_numbers[1] = "Alabama";
            state_numbers[2] = "Alaska";
            state_numbers[3] = "Arizona";
            state_numbers[4] = "Arkansas";
            state_numbers[5] = "California";
            state_numbers[6] = "Colorado";
            state_numbers[7] = "Connecticut";
            state_numbers[8] = "Delaware";
            state_numbers[9] = "Florida";
            state_numbers[10] = "Georgia";
            state_numbers[11] = "Hawaii";
            state_numbers[12] = "Idaho";
            state_numbers[13] = "Illinois";
            state_numbers[14] = "Indiana";
            state_numbers[15] = "Iowa";
            state_numbers[16] = "Kansas";
            state_numbers[17] = "Kentucky";
            state_numbers[18] = "Louisiana";
            state_numbers[19] = "Maine";
            state_numbers[20] = "Maryland";
            state_numbers[21] = "Massachusetts";
            state_numbers[22] = "Michigan";
            state_numbers[23] = "Minnesota";
            state_numbers[24] = "Mississippi";
            state_numbers[25] = "Missouri";
            state_numbers[26] = "Montana";
            state_numbers[27] = "Nebraska";
            state_numbers[28] = "Nevada";
            state_numbers[29] = "New Hampshire";
            state_numbers[30] = "New Jersey";
            state_numbers[31] = "New Mexico";
            state_numbers[32] = "New York";
            state_numbers[33] = "North Carolina";
            state_numbers[34] = "North Dakota";
            state_numbers[35] = "Ohio";
            state_numbers[36] = "Oklahoma";
            state_numbers[37] = "Oregon";
            state_numbers[38] = "Pennsylvania";
            state_numbers[39] = "Rhode Island";
            state_numbers[40] = "South Carolina";
            state_numbers[41] = "South Dakota";
            state_numbers[42] = "Tennessee";
            state_numbers[43] = "Texas";
            state_numbers[44] = "Utah";
            state_numbers[45] = "Vermont";
            state_numbers[46] = "Virginia";
            state_numbers[47] = "Washington";
            state_numbers[48] = "West Virginia";
            state_numbers[49] = "Wisconsin";
            state_numbers[50] = "Wyoming";


            var file = "http://api.census.gov/data/2012/acs5?get=B01001_001E,B03001_001E&for=state:*";

            var data = "";

            $.ajaxSetup({async:false});
            $.getJSON(file, function(jsonData) {
                data = jsonData;
            });

            newData = {}
            for(i = 1; i < data.length; i++){
                newData[i] = data[i][0];
            };

            retData = {};
            for(i = 1; i < data.length; i++){
                var value = parseInt(newData[i]) / 1000000;
                retData[state_numbers[i]] = value.toString();
            };

            return retData;

        }

        var map = new GradientMap();
        map.setNationalDataFunction(getStateData);
        map.setup();
        map.drawMap();

    </script>
</body>
</html>